<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cykj.online_market_admin.mapper.MenuMapper">
    <!--    获取菜单-->
    <select id="getMenu" parameterType="java.lang.Integer" resultMap="menuMap">
    select m.id,name,url,parent_id ,role_id
    from t_Menu m,t_role_menu r
    where parent_id=0 and m.id=r.menu_id and r.role_id= #{role_id}
    </select>
    <!--    父级菜单获取子菜单的 映射结果集-->
    <resultMap id="menuMap" type="com.cykj.online_market_bean.pojo.Menu">
        <id column="parent_id" property="parentId"></id>
        <id column="role_id" property="roleId"></id>
        <collection property="childList" ofType="com.cykj.online_market_bean.pojo.Menu" javaType="java.util.ArrayList"
                    column="{id=id,role_id=role_id}" select="getChildMenu">
        </collection>
    </resultMap>
    <!--    获取父级菜单的子菜单-->
    <select id="getChildMenu"  resultType="com.cykj.online_market_bean.pojo.Menu">
     select m.id,name,url,m.parent_id
     from t_menu m,t_role_menu r
     where parent_id=#{id} and m.id=r.menu_id and r.role_id= #{role_id};
    </select>

</mapper>